# Comparing `tmp/rqpattr-0.0.15-cp39-cp39-win_amd64.whl.zip` & `tmp/rqpattr-0.0.17-cp39-cp39-win_amd64.whl.zip`

## zipinfo {}

```diff
@@ -1,61 +1,68 @@
-Zip file size: 1425065 bytes, number of entries: 59
--rw-rw-rw-  2.0 fat      176 b- defN 23-Apr-03 06:20 rqpattr/__init__.py
--rw-rw-rw-  2.0 fat      519 b- defN 23-Apr-03 06:22 rqpattr/_version.py
--rw-rw-rw-  2.0 fat   101888 b- defN 23-Apr-03 06:22 rqpattr/api.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat     3477 b- defN 23-Apr-03 06:20 rqpattr/const.py
--rw-rw-rw-  2.0 fat     2693 b- defN 23-Apr-03 06:20 rqpattr/exceptions.py
--rw-rw-rw-  2.0 fat      394 b- defN 23-Apr-03 06:20 rqpattr/logger.py
--rw-rw-rw-  2.0 fat      297 b- defN 23-Apr-03 06:20 rqpattr/types.py
--rw-rw-rw-  2.0 fat       25 b- defN 23-Apr-03 06:20 rqpattr/analysis/__init__.py
--rw-rw-rw-  2.0 fat    52224 b- defN 23-Apr-03 06:20 rqpattr/analysis/allocation_selection.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat   129536 b- defN 23-Apr-03 06:20 rqpattr/analysis/benchmark.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat   121856 b- defN 23-Apr-03 06:20 rqpattr/analysis/cache.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat   196096 b- defN 23-Apr-03 06:21 rqpattr/analysis/classification.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat   132096 b- defN 23-Apr-03 06:21 rqpattr/analysis/context.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat    39424 b- defN 23-Apr-03 06:21 rqpattr/analysis/credit_score.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat    44544 b- defN 23-Apr-03 06:21 rqpattr/analysis/linking.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat   125440 b- defN 23-Apr-03 06:21 rqpattr/analysis/portfolio_performance.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat   116224 b- defN 23-Apr-03 06:21 rqpattr/analysis/return_decomposition.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat      106 b- defN 23-Apr-03 06:20 rqpattr/analysis/bond_factor/__init__.py
--rw-rw-rw-  2.0 fat    71168 b- defN 23-Apr-03 06:21 rqpattr/analysis/bond_factor/analysis.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat   471040 b- defN 23-Apr-03 06:21 rqpattr/analysis/bond_factor/attribution.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat    64512 b- defN 23-Apr-03 06:21 rqpattr/analysis/bond_factor/convertible.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat       40 b- defN 23-Apr-03 06:20 rqpattr/analysis/brinson/__init__.py
--rw-rw-rw-  2.0 fat    92672 b- defN 23-Apr-03 06:21 rqpattr/analysis/brinson/analysis.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat    53248 b- defN 23-Apr-03 06:21 rqpattr/analysis/brinson/brinson.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat    84992 b- defN 23-Apr-03 06:21 rqpattr/analysis/brinson/index_cache.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat       45 b- defN 23-Apr-03 06:20 rqpattr/analysis/campisi/__init__.py
--rw-rw-rw-  2.0 fat   121856 b- defN 23-Apr-03 06:21 rqpattr/analysis/campisi/analysis.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat   185344 b- defN 23-Apr-03 06:22 rqpattr/analysis/campisi/campisi.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat    84992 b- defN 23-Apr-03 06:22 rqpattr/analysis/campisi/index_cache.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat       40 b- defN 23-Apr-03 06:20 rqpattr/analysis/hedging/__init__.py
--rw-rw-rw-  2.0 fat   117760 b- defN 23-Apr-03 06:22 rqpattr/analysis/hedging/analysis.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat    60928 b- defN 23-Apr-03 06:22 rqpattr/analysis/hedging/drilldown.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat    86528 b- defN 23-Apr-03 06:22 rqpattr/analysis/hedging/hedging.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat       71 b- defN 23-Apr-03 06:20 rqpattr/analysis/stock_factor/__init__.py
--rw-rw-rw-  2.0 fat   111616 b- defN 23-Apr-03 06:22 rqpattr/analysis/stock_factor/analysis.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat    25088 b- defN 23-Apr-03 06:22 rqpattr/analysis/stock_factor/const.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat    62976 b- defN 23-Apr-03 06:22 rqpattr/analysis/stock_factor/factor_based.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat    75264 b- defN 23-Apr-03 06:22 rqpattr/analysis/stock_factor/factor_exposure.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat    99840 b- defN 23-Apr-03 06:22 rqpattr/analysis/stock_factor/index_cache.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat    48128 b- defN 23-Apr-03 06:22 rqpattr/analysis/stock_factor/risk.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat    56832 b- defN 23-Apr-03 06:22 rqpattr/analysis/stock_factor/sensitivity.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat      172 b- defN 23-Apr-03 06:20 rqpattr/marketdata/__init__.py
--rw-rw-rw-  2.0 fat     3249 b- defN 23-Apr-03 06:20 rqpattr/marketdata/bond_data.py
--rw-rw-rw-  2.0 fat     1700 b- defN 23-Apr-03 06:20 rqpattr/marketdata/calendar_data.py
--rw-rw-rw-  2.0 fat    10582 b- defN 23-Apr-03 06:20 rqpattr/marketdata/daily_return_data.py
--rw-rw-rw-  2.0 fat     3007 b- defN 23-Apr-03 06:20 rqpattr/marketdata/index_weight_data.py
--rw-rw-rw-  2.0 fat     4644 b- defN 23-Apr-03 06:20 rqpattr/marketdata/industry_data.py
--rw-rw-rw-  2.0 fat     5197 b- defN 23-Apr-03 06:20 rqpattr/marketdata/instruments_data.py
--rw-rw-rw-  2.0 fat     1668 b- defN 23-Apr-03 06:20 rqpattr/marketdata/price_data.py
--rw-rw-rw-  2.0 fat   248023 b- defN 23-Apr-03 06:20 rqpattr/marketdata/shenwan.pkl
--rw-rw-rw-  2.0 fat        0 b- defN 23-Apr-03 06:20 rqpattr/utils/__init__.py
--rw-rw-rw-  2.0 fat     3616 b- defN 23-Apr-03 06:20 rqpattr/utils/debug.py
--rw-rw-rw-  2.0 fat     4025 b- defN 23-Apr-03 06:20 rqpattr/utils/decorators.py
--rw-rw-rw-  2.0 fat     2662 b- defN 23-Apr-03 06:20 rqpattr/utils/format.py
--rw-rw-rw-  2.0 fat     2011 b- defN 23-Apr-03 06:20 rqpattr/utils/pandas_util.py
--rw-rw-rw-  2.0 fat      905 b- defN 23-Apr-03 06:22 rqpattr-0.0.15.dist-info/METADATA
--rw-rw-rw-  2.0 fat      100 b- defN 23-Apr-03 06:22 rqpattr-0.0.15.dist-info/WHEEL
--rw-rw-rw-  2.0 fat        8 b- defN 23-Apr-03 06:22 rqpattr-0.0.15.dist-info/top_level.txt
-?rw-rw-r--  2.0 fat     5744 b- defN 23-Apr-03 06:22 rqpattr-0.0.15.dist-info/RECORD
-59 files, 3339308 bytes uncompressed, 1415729 bytes compressed:  57.6%
+Zip file size: 1464328 bytes, number of entries: 66
+-rw-rw-rw-  2.0 fat      176 b- defN 23-Jul-07 03:37 rqpattr/__init__.py
+-rw-rw-rw-  2.0 fat      519 b- defN 23-Jul-07 03:39 rqpattr/_version.py
+-rw-rw-rw-  2.0 fat   105984 b- defN 23-Jul-07 03:39 rqpattr/api.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat     3477 b- defN 23-Jul-07 03:37 rqpattr/const.py
+-rw-rw-rw-  2.0 fat     2693 b- defN 23-Jul-07 03:37 rqpattr/exceptions.py
+-rw-rw-rw-  2.0 fat      394 b- defN 23-Jul-07 03:37 rqpattr/logger.py
+-rw-rw-rw-  2.0 fat      297 b- defN 23-Jul-07 03:37 rqpattr/types.py
+-rw-rw-rw-  2.0 fat       25 b- defN 23-Jul-07 03:37 rqpattr/analysis/__init__.py
+-rw-rw-rw-  2.0 fat    52224 b- defN 23-Jul-07 03:38 rqpattr/analysis/allocation_selection.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat   129536 b- defN 23-Jul-07 03:38 rqpattr/analysis/benchmark.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat   121856 b- defN 23-Jul-07 03:38 rqpattr/analysis/cache.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat   196096 b- defN 23-Jul-07 03:38 rqpattr/analysis/classification.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat   132096 b- defN 23-Jul-07 03:38 rqpattr/analysis/context.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat    39424 b- defN 23-Jul-07 03:38 rqpattr/analysis/credit_score.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat    44544 b- defN 23-Jul-07 03:38 rqpattr/analysis/linking.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat   125440 b- defN 23-Jul-07 03:38 rqpattr/analysis/portfolio_performance.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat   116224 b- defN 23-Jul-07 03:38 rqpattr/analysis/return_decomposition.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat      106 b- defN 23-Jul-07 03:37 rqpattr/analysis/bond_factor/__init__.py
+-rw-rw-rw-  2.0 fat    71168 b- defN 23-Jul-07 03:38 rqpattr/analysis/bond_factor/analysis.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat   471040 b- defN 23-Jul-07 03:38 rqpattr/analysis/bond_factor/attribution.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat    64512 b- defN 23-Jul-07 03:38 rqpattr/analysis/bond_factor/convertible.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat       40 b- defN 23-Jul-07 03:37 rqpattr/analysis/brinson/__init__.py
+-rw-rw-rw-  2.0 fat    92672 b- defN 23-Jul-07 03:39 rqpattr/analysis/brinson/analysis.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat    53248 b- defN 23-Jul-07 03:39 rqpattr/analysis/brinson/brinson.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat    84992 b- defN 23-Jul-07 03:39 rqpattr/analysis/brinson/index_cache.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat       45 b- defN 23-Jul-07 03:37 rqpattr/analysis/campisi/__init__.py
+-rw-rw-rw-  2.0 fat   121856 b- defN 23-Jul-07 03:39 rqpattr/analysis/campisi/analysis.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat   185344 b- defN 23-Jul-07 03:39 rqpattr/analysis/campisi/campisi.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat    84992 b- defN 23-Jul-07 03:39 rqpattr/analysis/campisi/index_cache.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat       40 b- defN 23-Jul-07 03:37 rqpattr/analysis/hedging/__init__.py
+-rw-rw-rw-  2.0 fat   117760 b- defN 23-Jul-07 03:39 rqpattr/analysis/hedging/analysis.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat    60928 b- defN 23-Jul-07 03:39 rqpattr/analysis/hedging/drilldown.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat    86528 b- defN 23-Jul-07 03:39 rqpattr/analysis/hedging/hedging.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat       71 b- defN 23-Jul-07 03:37 rqpattr/analysis/stock_factor/__init__.py
+-rw-rw-rw-  2.0 fat   111616 b- defN 23-Jul-07 03:39 rqpattr/analysis/stock_factor/analysis.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat    25088 b- defN 23-Jul-07 03:39 rqpattr/analysis/stock_factor/const.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat    62976 b- defN 23-Jul-07 03:39 rqpattr/analysis/stock_factor/factor_based.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat    75264 b- defN 23-Jul-07 03:39 rqpattr/analysis/stock_factor/factor_exposure.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat    99840 b- defN 23-Jul-07 03:39 rqpattr/analysis/stock_factor/index_cache.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat    48128 b- defN 23-Jul-07 03:39 rqpattr/analysis/stock_factor/risk.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat    56832 b- defN 23-Jul-07 03:39 rqpattr/analysis/stock_factor/sensitivity.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat      172 b- defN 23-Jul-07 03:37 rqpattr/marketdata/__init__.py
+-rw-rw-rw-  2.0 fat     3249 b- defN 23-Jul-07 03:37 rqpattr/marketdata/bond_data.py
+-rw-rw-rw-  2.0 fat     1700 b- defN 23-Jul-07 03:37 rqpattr/marketdata/calendar_data.py
+-rw-rw-rw-  2.0 fat    10582 b- defN 23-Jul-07 03:37 rqpattr/marketdata/daily_return_data.py
+-rw-rw-rw-  2.0 fat     3007 b- defN 23-Jul-07 03:37 rqpattr/marketdata/index_weight_data.py
+-rw-rw-rw-  2.0 fat     4644 b- defN 23-Jul-07 03:37 rqpattr/marketdata/industry_data.py
+-rw-rw-rw-  2.0 fat     5875 b- defN 23-Jul-07 03:37 rqpattr/marketdata/instruments_data.py
+-rw-rw-rw-  2.0 fat     1668 b- defN 23-Jul-07 03:37 rqpattr/marketdata/price_data.py
+-rw-rw-rw-  2.0 fat   248023 b- defN 23-Jul-07 03:37 rqpattr/marketdata/shenwan.pkl
+-rw-rw-rw-  2.0 fat        0 b- defN 23-Jul-07 03:37 rqpattr/report/__init__.py
+-rw-rw-rw-  2.0 fat     9802 b- defN 23-Jul-07 03:37 rqpattr/report/excel.py
+-rw-rw-rw-  2.0 fat    10535 b- defN 23-Jul-07 03:37 rqpattr/report/templcate_based_excel.py
+-rw-rw-rw-  2.0 fat        0 b- defN 23-Jul-07 03:37 rqpattr/report/excel_templates/__init__.py
+-rw-rw-rw-  2.0 fat    12344 b- defN 23-Jul-07 03:37 rqpattr/report/excel_templates/brinson.xlsx
+-rw-rw-rw-  2.0 fat    13910 b- defN 23-Jul-07 03:37 rqpattr/report/excel_templates/factor.xlsx
+-rw-rw-rw-  2.0 fat    14141 b- defN 23-Jul-07 03:37 rqpattr/report/excel_templates/factor_v2.xlsx
+-rw-rw-rw-  2.0 fat        0 b- defN 23-Jul-07 03:37 rqpattr/utils/__init__.py
+-rw-rw-rw-  2.0 fat     3616 b- defN 23-Jul-07 03:37 rqpattr/utils/debug.py
+-rw-rw-rw-  2.0 fat     4025 b- defN 23-Jul-07 03:37 rqpattr/utils/decorators.py
+-rw-rw-rw-  2.0 fat     2662 b- defN 23-Jul-07 03:37 rqpattr/utils/format.py
+-rw-rw-rw-  2.0 fat     2011 b- defN 23-Jul-07 03:37 rqpattr/utils/pandas_util.py
+-rw-rw-rw-  2.0 fat      929 b- defN 23-Jul-07 03:39 rqpattr-0.0.17.dist-info/METADATA
+-rw-rw-rw-  2.0 fat      100 b- defN 23-Jul-07 03:39 rqpattr-0.0.17.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat        8 b- defN 23-Jul-07 03:39 rqpattr-0.0.17.dist-info/top_level.txt
+?rw-rw-r--  2.0 fat     6401 b- defN 23-Jul-07 03:39 rqpattr-0.0.17.dist-info/RECORD
+66 files, 3405495 bytes uncompressed, 1453940 bytes compressed:  57.3%
```

## zipnote {}

```diff
@@ -144,14 +144,35 @@
 
 Filename: rqpattr/marketdata/price_data.py
 Comment: 
 
 Filename: rqpattr/marketdata/shenwan.pkl
 Comment: 
 
+Filename: rqpattr/report/__init__.py
+Comment: 
+
+Filename: rqpattr/report/excel.py
+Comment: 
+
+Filename: rqpattr/report/templcate_based_excel.py
+Comment: 
+
+Filename: rqpattr/report/excel_templates/__init__.py
+Comment: 
+
+Filename: rqpattr/report/excel_templates/brinson.xlsx
+Comment: 
+
+Filename: rqpattr/report/excel_templates/factor.xlsx
+Comment: 
+
+Filename: rqpattr/report/excel_templates/factor_v2.xlsx
+Comment: 
+
 Filename: rqpattr/utils/__init__.py
 Comment: 
 
 Filename: rqpattr/utils/debug.py
 Comment: 
 
 Filename: rqpattr/utils/decorators.py
@@ -159,20 +180,20 @@
 
 Filename: rqpattr/utils/format.py
 Comment: 
 
 Filename: rqpattr/utils/pandas_util.py
 Comment: 
 
-Filename: rqpattr-0.0.15.dist-info/METADATA
+Filename: rqpattr-0.0.17.dist-info/METADATA
 Comment: 
 
-Filename: rqpattr-0.0.15.dist-info/WHEEL
+Filename: rqpattr-0.0.17.dist-info/WHEEL
 Comment: 
 
-Filename: rqpattr-0.0.15.dist-info/top_level.txt
+Filename: rqpattr-0.0.17.dist-info/top_level.txt
 Comment: 
 
-Filename: rqpattr-0.0.15.dist-info/RECORD
+Filename: rqpattr-0.0.17.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## rqpattr/_version.py

```diff
@@ -4,18 +4,18 @@
 # unpacked source archive. Distribution tarballs contain a pre-generated copy
 # of this file.
 
 import json
 
 version_json = '''
 {
- "date": "2023-04-03T14:19:16+0800",
+ "date": "2023-06-30T14:40:46+0800",
  "dirty": false,
  "error": null,
- "full-revisionid": "71d7bebdd05feec6d45c6f9799dfa407317a1616",
- "version": "0.0.15"
+ "full-revisionid": "183a0ee8fded1ac8a759cb1772a65fa074abd854",
+ "version": "0.0.17"
 }
 '''  # END VERSION_JSON
 
 
 def get_versions():
     return json.loads(version_json)
```

## rqpattr/marketdata/instruments_data.py

```diff
@@ -1,13 +1,14 @@
 import time
 from collections import defaultdict
 from functools import lru_cache
 from typing import List, Dict, Optional, Set, Iterable
 
 import rqdatac
+from rqdatac.share.errors import BadRequest
 import rqdatac_fund
 
 from rqpattr.const import AssetType
 from rqpattr.logger import logger
 
 
 class AssetTypeCache:
@@ -76,15 +77,20 @@
     # type_cache.put_many(bonds, AssetType.BOND)
     df = rqdatac.all_instruments()
     df = df[["order_book_id", "type"]]
     for row in df.itertuples(index=False):
         if row.type in asset_type_map:
             type_cache.put_one(row.order_book_id, asset_type_map[row.type])
 
-    type_cache.put_many(rqdatac.fund.all_instruments().order_book_id, AssetType.PUBLIC_FUND)
+    # 可能没有公募基金数据，尝试获取一下，如果报错了就不管
+    try:
+        type_cache.put_many(rqdatac.fund.all_instruments().order_book_id, AssetType.PUBLIC_FUND)
+    except BadRequest as e:
+        if "can't find" not in str(e).lower():
+            raise e
 
     _type_cache.set_expire(time.time() + 6 * 3600)
     end = time.time()
     logger.info(f"finish update instrument asset type cache, spend {end - start:,} s")
 
 
 def update_if_needed():
@@ -92,15 +98,24 @@
         _update_type()
 
 
 def _get_instrument(order_book_id):
     asset_type = _type_cache.get_one(order_book_id)
     if asset_type is None:
         for getter in instrument_getters:
-            ins = getter(order_book_id)
+            try:
+                ins = getter(order_book_id)
+            except BadRequest as e:
+                # 可能对应的品种没有数据，没有部署对应的rqdatad API
+                # 在这种情况下，rqdatad 会返回 BadRequest: Can't find xxx
+                # 异常，这种情况下忽略掉此异常.
+                if "can't find" not in str(e).lower():
+                    raise e
+                else:
+                    ins = None
             if ins is not None:
                 return ins
         return
     elif asset_type == AssetType.BOND:
         return rqdatac.bond.instruments(order_book_id)
     elif asset_type == AssetType.CONVERTIBLE:
         return rqdatac.convertible.instruments(order_book_id)
```

## Comparing `rqpattr-0.0.15.dist-info/METADATA` & `rqpattr-0.0.17.dist-info/METADATA`

 * *Files 6% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: rqpattr
-Version: 0.0.15
+Version: 0.0.17
 Summary: ricequant performance attribution lib
 Home-page: https://www.ricequant.com/
 Author: Ricequant
 Author-email: public@ricequant.com
 License: UNKNOWN
 Keywords: rqpattr
 Platform: UNKNOWN
@@ -17,14 +17,15 @@
 Requires-Dist: numpy
 Requires-Dist: pandas
 Requires-Dist: statsmodels
 Requires-Dist: scipy
 Requires-Dist: rqdatac
 Requires-Dist: rqdatac-fund
 Requires-Dist: sentry-sdk
+Requires-Dist: openpyxl
 
 # performance attribution
 
 ## env variables
 
 ```text
 RQPATTR_CACHE_MONGODB                       mongodb url for caching
```

## Comparing `rqpattr-0.0.15.dist-info/RECORD` & `rqpattr-0.0.17.dist-info/RECORD`

 * *Files 8% similar despite different names*

```diff
@@ -1,59 +1,66 @@
 rqpattr/__init__.py,sha256=Dy-u3Wglo39HXehhTI9mSlMInj22_wdV-6iCt_T5ccU,176
-rqpattr/_version.py,sha256=6yzne8Ps3EP0EIPbpKr4LCNWMD0xSSksXlx8u84NT7c,519
-rqpattr/api.cp39-win_amd64.pyd,sha256=JhdhNHIM_1vUD39-LjOpzL_0y2vPKvfLpT85JkSy9TA,101888
+rqpattr/_version.py,sha256=s4K0sxOBQlQioC-MNgMr5op21DY6zA5LbGNSy0bjZCM,519
+rqpattr/api.cp39-win_amd64.pyd,sha256=5Qoi8lDTBQJFr4CL7a01TrK00RFOJrd4qkcKzfmCRAg,105984
 rqpattr/const.py,sha256=kjP2RhbdNRY51hGQU2D3xbpC7Rkv-7Fhuq7oR4yi7MA,3477
 rqpattr/exceptions.py,sha256=Bi5pXY0O_n2eJUris2gBISKId68sWkd1ta30tUap8Lw,2693
 rqpattr/logger.py,sha256=0MPRnKGp1aNLKcKyCl5ktKuk28z9HL1sHbhHt9vOc8M,394
 rqpattr/types.py,sha256=RVUzAJx_RAgTWThQzlYvNaxKVIYodBSfbPSl1HYKeb0,297
 rqpattr/analysis/__init__.py,sha256=lVL4VPz3c4kWCgjPtL4uuQLNmgwK92q1ffAsv5El02k,25
-rqpattr/analysis/allocation_selection.cp39-win_amd64.pyd,sha256=TUiUdcXJC1NUqOLY4n85Jq2g10ZAZ02Vc_hQXoHNm1w,52224
-rqpattr/analysis/benchmark.cp39-win_amd64.pyd,sha256=hEDEc1kX6yIeWFpx_VkeTCW36vf3VqrXuxDXkJd8rB8,129536
-rqpattr/analysis/cache.cp39-win_amd64.pyd,sha256=uEVoTwHpK33df0NVFn6iVKa_M6Sc4lqtt53ub26YYBU,121856
-rqpattr/analysis/classification.cp39-win_amd64.pyd,sha256=tA9EpZlRjX8iR3jyPUcjwDHFZb38ZBs6pljn9if6UVU,196096
-rqpattr/analysis/context.cp39-win_amd64.pyd,sha256=LGqniLkDKfOTO8LjmyrJG7EGDdE7dPhm_hbKVT5Yd3s,132096
-rqpattr/analysis/credit_score.cp39-win_amd64.pyd,sha256=NaJ1hfyuTjIXon-8JN_quHQnLIExs-YY1shP7-DASiw,39424
-rqpattr/analysis/linking.cp39-win_amd64.pyd,sha256=DQ_alcsMcgzB_u5P8ETZqHXano5uOcvUYRdLM-ZcxnQ,44544
-rqpattr/analysis/portfolio_performance.cp39-win_amd64.pyd,sha256=qSkVqEb4fQAbttA6gNZ-cCW4sPL4P7NbonviVWFENiU,125440
-rqpattr/analysis/return_decomposition.cp39-win_amd64.pyd,sha256=7PGiERV6AMxjUCvDj0BHTsnnNpUT2fXl_GA-y9Zsyf8,116224
+rqpattr/analysis/allocation_selection.cp39-win_amd64.pyd,sha256=RTuhqC14AG3PMRlUpnmpYoFxwS5LrEvUFeMQhjRpJgQ,52224
+rqpattr/analysis/benchmark.cp39-win_amd64.pyd,sha256=bnUFo8zwotl49Fp5rh_9w7UhRurk2mtUiT6NUJysrbs,129536
+rqpattr/analysis/cache.cp39-win_amd64.pyd,sha256=DSPJStoBJiCrgOapYYApVS0z0BQdFOsYVgsUWVedQUA,121856
+rqpattr/analysis/classification.cp39-win_amd64.pyd,sha256=upq7K6WfdTVKKK8CuqfPPMfrcE_Z4l8Druljjs7TKEM,196096
+rqpattr/analysis/context.cp39-win_amd64.pyd,sha256=0NwYruEuIiddtjO5xVNYRmBhkms0WAf4wf1hRVWJh94,132096
+rqpattr/analysis/credit_score.cp39-win_amd64.pyd,sha256=79AAbe8oN-3RJ5A6dLJscbLQSr_6vKKvbSXwK6HEOgk,39424
+rqpattr/analysis/linking.cp39-win_amd64.pyd,sha256=ZlU0-Kv70VFBbyD23eWIAFs0o7tD4XMj33ddZX34oY8,44544
+rqpattr/analysis/portfolio_performance.cp39-win_amd64.pyd,sha256=52lvso0IPzVB6vXatLhDwg8eKyZtTGvDLp7D1hE0Dhc,125440
+rqpattr/analysis/return_decomposition.cp39-win_amd64.pyd,sha256=FNx7v8XIvPfYYa6jglyjO7bYje6Go4kouhSU0hDHR1U,116224
 rqpattr/analysis/bond_factor/__init__.py,sha256=qCfDWwUH5x8Ovod2UrmiRpl2MRTIV8F_-Sf9ISYVpog,106
-rqpattr/analysis/bond_factor/analysis.cp39-win_amd64.pyd,sha256=xh2c7KpjJgBqxG5YThPj7FVC1_MMx2gGT3mDwCHBoAU,71168
-rqpattr/analysis/bond_factor/attribution.cp39-win_amd64.pyd,sha256=GmoQiYfI6LNS6lgBHumdCQPQv9BbWkoaBn8-Tupt1fI,471040
-rqpattr/analysis/bond_factor/convertible.cp39-win_amd64.pyd,sha256=M3tb0KTm6OXYtkOgm0097KegGrRA88GaLGoUoAjkcE8,64512
+rqpattr/analysis/bond_factor/analysis.cp39-win_amd64.pyd,sha256=Lj_Q9saoU2KODYmZG83h5s6Z5X3U4ybZpFWLUGl_e64,71168
+rqpattr/analysis/bond_factor/attribution.cp39-win_amd64.pyd,sha256=FZKhGIXTYZHmhoQ-66W907PELq0DvaD-XDQzogxlDcE,471040
+rqpattr/analysis/bond_factor/convertible.cp39-win_amd64.pyd,sha256=-f5KVXxd77Ee0roXxzFblqr4QnZCzQT_L46uAsn4LtQ,64512
 rqpattr/analysis/brinson/__init__.py,sha256=okS92IUJR5rkk4gvTZ-_OR4JKghWxM1nDVysGucHXKE,40
-rqpattr/analysis/brinson/analysis.cp39-win_amd64.pyd,sha256=hwjTmRk56j5k-Z_xHoOM8xuc5dZYzVV0Yu2BGv5MYT8,92672
-rqpattr/analysis/brinson/brinson.cp39-win_amd64.pyd,sha256=liEEVGphNcAAD1joWGp7MjPtBCQFX4UaHUkrG-bxYK4,53248
-rqpattr/analysis/brinson/index_cache.cp39-win_amd64.pyd,sha256=IIpQLncPYoQq1Of4yj6UfsehaUb6R_Un6k_2teDhbMA,84992
+rqpattr/analysis/brinson/analysis.cp39-win_amd64.pyd,sha256=SJtxD9z1gn8ass7QDQT6XJiI6m8s0gvd7nzRcARu2iI,92672
+rqpattr/analysis/brinson/brinson.cp39-win_amd64.pyd,sha256=3fo9cx2KG48GHOxzke0y2LglLRaREyFkxLqxh02_Z-o,53248
+rqpattr/analysis/brinson/index_cache.cp39-win_amd64.pyd,sha256=NgM9ODS4VWKE6C-nhG0EyREn_TJJgs6VIdB61YPnZSg,84992
 rqpattr/analysis/campisi/__init__.py,sha256=dQq5UqLl8YYgszqkwR9AWztk6gPe6klzn2aeVmeQZTg,45
-rqpattr/analysis/campisi/analysis.cp39-win_amd64.pyd,sha256=u2IctPyWDK7nlhpT1RHTLeIw9ax9onbN5VoNLKDfeFw,121856
-rqpattr/analysis/campisi/campisi.cp39-win_amd64.pyd,sha256=LEcEWUwT5uyRe2_yEWvJmfaRiwkG9khJyMJQLca1dio,185344
-rqpattr/analysis/campisi/index_cache.cp39-win_amd64.pyd,sha256=DAfYkCKmKo-JbJc6k1_tXGLs8e7QMwrDGVz3TGSXLEk,84992
+rqpattr/analysis/campisi/analysis.cp39-win_amd64.pyd,sha256=l_xwqXrE_1PNHsCpFEL7BVzAvc7qJ7ZIj-fhaIPc3dE,121856
+rqpattr/analysis/campisi/campisi.cp39-win_amd64.pyd,sha256=_4_Xd7zEoJ5MwvTNm1tWz0MV3v1xX6G9p3O_Euo9Ak8,185344
+rqpattr/analysis/campisi/index_cache.cp39-win_amd64.pyd,sha256=eqasEi5TT2SVYMcb7j6CkLZz74bsmDLVpvX_um9kcDs,84992
 rqpattr/analysis/hedging/__init__.py,sha256=JucA9y7FB21pOUNzck8tQkSL3KvsmJ67fqxRWTgwXUU,40
-rqpattr/analysis/hedging/analysis.cp39-win_amd64.pyd,sha256=LtPkPakls4-o0qSGtZ7Bixnh9a57NDgP3AKjJymTB0A,117760
-rqpattr/analysis/hedging/drilldown.cp39-win_amd64.pyd,sha256=xwH2Wtm56RRKlxJhRE_M9O8MOF6qKJKGCUeBHR85LVk,60928
-rqpattr/analysis/hedging/hedging.cp39-win_amd64.pyd,sha256=OfwlPZTY7lGm8RdDo988bzhZ6qe3f04_KkDF9fninxQ,86528
+rqpattr/analysis/hedging/analysis.cp39-win_amd64.pyd,sha256=S-HOMs17wXpnrOQgruzGJMLlq-NGYVFnJN36AV55YuQ,117760
+rqpattr/analysis/hedging/drilldown.cp39-win_amd64.pyd,sha256=HVZy0lH2itU0Dl0iqIVtKJXrIPVe9K7PMN6gEh9h7wI,60928
+rqpattr/analysis/hedging/hedging.cp39-win_amd64.pyd,sha256=XHOz_7JjzAvq5f6trW5qUphrdTWP2cJ8BRTk61_sTBg,86528
 rqpattr/analysis/stock_factor/__init__.py,sha256=pQvQCJrvA3F-ejsu_pLOlCDftMgGjLmvjJTp9e1Higs,71
-rqpattr/analysis/stock_factor/analysis.cp39-win_amd64.pyd,sha256=f3jxIpPoZAtRoSYvmR58qhz_SXkNSQCBChUXvzr534E,111616
-rqpattr/analysis/stock_factor/const.cp39-win_amd64.pyd,sha256=a_gdYJ3gYg8kz-gwXAOWhRk5D-Dk2UNW_NGHx5Wxeos,25088
-rqpattr/analysis/stock_factor/factor_based.cp39-win_amd64.pyd,sha256=JVq6Y_uFzmW7kXY390fWE9uwJwP-ekjtX74D9FY52KI,62976
-rqpattr/analysis/stock_factor/factor_exposure.cp39-win_amd64.pyd,sha256=0dIiHlQ6KZA9qQ9dacaeVuM-df5AoikRiESxru9uHIA,75264
-rqpattr/analysis/stock_factor/index_cache.cp39-win_amd64.pyd,sha256=TPix7uom__OLH6_GxbTONaGfS5PS6SslWOywojtNCwE,99840
-rqpattr/analysis/stock_factor/risk.cp39-win_amd64.pyd,sha256=Fz8Z9NqmRIas7vHJpmJ5XHcLYbqjYkJk05zXYPRScXk,48128
-rqpattr/analysis/stock_factor/sensitivity.cp39-win_amd64.pyd,sha256=J4hRta7zz9Ss5bT6WZEXEohaN4PFPL4RuCp9oac1xDY,56832
+rqpattr/analysis/stock_factor/analysis.cp39-win_amd64.pyd,sha256=zHxk48MJAHhdbPNYgeCND_PD2QKMQCD-G9HcayqlaFU,111616
+rqpattr/analysis/stock_factor/const.cp39-win_amd64.pyd,sha256=csws9gzF5Meg1leRc2RJeohbWXX8R3djy4iGHZ7EScM,25088
+rqpattr/analysis/stock_factor/factor_based.cp39-win_amd64.pyd,sha256=qdhgXgEJiW8RLfBl_14u_-Fi2iLGAX9pltRqQLJ4a0o,62976
+rqpattr/analysis/stock_factor/factor_exposure.cp39-win_amd64.pyd,sha256=5dvXS0eCaSvPxm5cUWO0vDJ4wZK3MtYRmNiFFNVypok,75264
+rqpattr/analysis/stock_factor/index_cache.cp39-win_amd64.pyd,sha256=sc6YVYXnCWVSAH-1mYQyxIoAnZ7oJ9qWEDJhfvgH2JQ,99840
+rqpattr/analysis/stock_factor/risk.cp39-win_amd64.pyd,sha256=TrNw1ybDgBsW0yXsIvXwhYXVuKwB2V-algBW6TOvl9U,48128
+rqpattr/analysis/stock_factor/sensitivity.cp39-win_amd64.pyd,sha256=Rrp8MUDtTC3rT1TJcMjgKujJh_2UvuaLs2IWy7ATOnY,56832
 rqpattr/marketdata/__init__.py,sha256=rGrb0-Qhtfuq0wfestHR4Q3c0Tn_C8m4fUmEc3QPzy8,172
 rqpattr/marketdata/bond_data.py,sha256=Wcs-FE9TdFhrxFR05x83cxQpunNEojy9pZV1-8rOf3E,3249
 rqpattr/marketdata/calendar_data.py,sha256=PEG2NoNegTA0OFtfdWAi2DgyWjeH7HRh1cDy3wIdWXE,1700
 rqpattr/marketdata/daily_return_data.py,sha256=2Gj7DOebQDkSJ8U4rdBWzFoD_SzeYjpKLzX3PruRHsA,10582
 rqpattr/marketdata/index_weight_data.py,sha256=dD04iRBAXlNMBWyhX3ToG5T8AacygJMCCoPw-zobYz4,3007
 rqpattr/marketdata/industry_data.py,sha256=jAnkbnR3XESoLwiUFPoQUkKlgbTAppZS2mjY7DBzGQo,4644
-rqpattr/marketdata/instruments_data.py,sha256=_pmW7vEJjfTgyiJ_JXQlPYSzpSfnIM0bmnd9BP-rdF0,5197
+rqpattr/marketdata/instruments_data.py,sha256=iydbDvkegM-xYhbwXq1dOaSo569sOtbwpI5amT_qm-g,5875
 rqpattr/marketdata/price_data.py,sha256=5bpszKb5pxu3zrE13hTO5Sjjsv8ZVxkwZAVx_fpY5qA,1668
 rqpattr/marketdata/shenwan.pkl,sha256=rPXSMOpIzYs9wvangaWkl7JJOwYnibDve62DqrjSPtU,248023
+rqpattr/report/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
+rqpattr/report/excel.py,sha256=fVPdhQV9kZQfbXUORkSw_r6QfvZ5tntkCbIOpVCKwv0,9802
+rqpattr/report/templcate_based_excel.py,sha256=gcFqxKZyWzBJPo0U4IqwpUaHz4m2RGXaVk4N8wh9ORA,10535
+rqpattr/report/excel_templates/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
+rqpattr/report/excel_templates/brinson.xlsx,sha256=ZnplABEjB9G2Lra2Bs_Z_MPgjj_z9jMlAJdZNQCALdI,12344
+rqpattr/report/excel_templates/factor.xlsx,sha256=NapFrcb1KkVNWzvo5Cpa72epiesHutnpwgQHZeVt1NE,13910
+rqpattr/report/excel_templates/factor_v2.xlsx,sha256=s8IclNeNCxjNOJwVUYcCuh0O8XWmDhHTX2WyAft2PB8,14141
 rqpattr/utils/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 rqpattr/utils/debug.py,sha256=qcslilbSyJkTDsIQZEBnrb9iOsTCg1A4mOQLxLLGYqU,3616
 rqpattr/utils/decorators.py,sha256=ld4gsq8QGpeQpDikpVMcbzw26N-IbCPuNR_KnqHvUDo,4025
 rqpattr/utils/format.py,sha256=DF72uBgsP97q973rdb9gxTW8COZgJYi0ggpisGPUtPA,2662
 rqpattr/utils/pandas_util.py,sha256=6AhlG5dNuT5eugvCoDnPdLjjNtcaSVh9kU1PiIufFTU,2011
-rqpattr-0.0.15.dist-info/METADATA,sha256=uv-OnuQzngbcu5KMhV8ivH3Rqcei6Ns7vnVBV9rr560,905
-rqpattr-0.0.15.dist-info/WHEEL,sha256=jr7ubY0Lkz_yXH9FfFe9PTtLhGOsf62dZkNvTYrJINE,100
-rqpattr-0.0.15.dist-info/top_level.txt,sha256=bkemQ-g0K3fRwzRX39H6WmEVCPPHGprLAtRJilG8i08,8
-rqpattr-0.0.15.dist-info/RECORD,,
+rqpattr-0.0.17.dist-info/METADATA,sha256=eG3bzJ7t-xjCINryE0_Ff648vFUz4thhuAO_1VVezDM,929
+rqpattr-0.0.17.dist-info/WHEEL,sha256=jr7ubY0Lkz_yXH9FfFe9PTtLhGOsf62dZkNvTYrJINE,100
+rqpattr-0.0.17.dist-info/top_level.txt,sha256=bkemQ-g0K3fRwzRX39H6WmEVCPPHGprLAtRJilG8i08,8
+rqpattr-0.0.17.dist-info/RECORD,,
```

